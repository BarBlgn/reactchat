(this.webpackJsonpreactchat2=this.webpackJsonpreactchat2||[]).push([[0],{134:function(e,t,a){e.exports=a(242)},242:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(40),s=a.n(c),o=(a(92),a(14)),i=a(49),l=(a(37),a(7)),u=a(4),m=a.n(u),d=a(8),p=a(15),f=a(16),v=a(18),h=a(17),b=a(50),g=a.n(b);g.a.apps.length?g.a.app():g.a.initializeApp({apiKey:"AIzaSyC6zWRnYvgSfWF7AfsqCCaL18YKD4VIOkI",authDomain:"reactchat-3a4dc.firebaseapp.com",databaseURL:"https://reactchat-3a4dc.firebaseio.com",projectId:"reactchat-3a4dc",storageBucket:"reactchat-3a4dc.appspot.com",messagingSenderId:"71361254830",appId:"1:71361254830:web:cc7cf5c53d164db98ae43f",measurementId:"G-6Z255M0NRW"});var j=g.a,E=(a(64),a(28)),O=a.n(E),y=a(27),C=(a(160),a(23)),w=a(41),k=Object(w.b)({name:"member",initialState:{username:"",color:"",showregisterform:"",showvideocall:""},reducers:{setUsername:function(e){e.username=e.nickname},setShowRegisterForm:function(e,t){e.showregisterform+=t.payload},setShowVideoCall:function(e,t){e.showvideocall+=t.payload},setColor:function(e){e.color=e.selectedcolor},incrementByAmount:function(e,t){e.username+=t.payload},incrementColor:function(e,t){e.color+=t.payload}}}),S=k.actions,x=(S.setUsername,S.setColor,S.incrementByAmount),L=(S.incrementColor,S.setShowRegisterForm),N=S.setShowVideoCall,T=function(e){return e.member.username},U=function(e){return e.member.color},D=function(e){return e.member.showregisterform},M=function(e){return e.member.showvideocall},_=k.reducer;a(161),a(233);var B=function(e){Object(v.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(p.a)(this,a),(n=t.call(this,e)).componentDidMount=function(){navigator.mediaDevices.getUserMedia({video:!0}).then((function(e){return n.videoTag.current.srcObject=e})).catch(console.log)},n.handleVideo=function(e){n.setState({videoSrc:e})},n.videoError=function(){},n.closeCall=function(){var e=n.props.id;j.database().ref("calls/"+e).update({deleted:!0})},n.onStartCallClicked=function(){j.database().ref("calls").push({from:n.props.user,to:n.state.userToCall,rejected:!1,accepted:!1,deleted:!1}),n.setState({loading:!0})},n.renderVideos=function(){return r.a.createElement("video",{id:n.props.id,ref:n.videoTag,width:n.props.width,height:n.props.height,autoPlay:!0,title:n.props.title})},n.renderForms=function(){return r.a.createElement("div",{key:"a",className:"form"},r.a.createElement("label",null,n.props.user," Call to"),r.a.createElement("input",{value:n.state.userToCall,type:"text",onChange:function(e){return n.setState({userToCall:e.target.value})}}),r.a.createElement("button",{onClick:n.onStartCallClicked,id:"call-btn",className:"btn btn-primary"},"Call"))},n.state={userToCall:null,loading:!1},n.closeCall=n.closeCall.bind(Object(y.a)(n)),n.videoTag=r.a.createRef(),n}return Object(f.a)(a,[{key:"render",value:function(){var e="",t="";return this.props.connectedUser&&(e=r.a.createElement(o.a,{onClick:this.closeCall,className:"close call",icon:C.c})),this.state.loading&&(t="Calling..."),r.a.createElement("div",{id:"camera-body"},r.a.createElement("section",{id:"container"},this.props.connectedUser?null:this.renderForms(),this.renderVideos(),t,e))}}]),a}(r.a.Component),I=function(){var e=Object(d.a)(m.a.mark((function e(t,a,n,r,c,s){var o;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.addStream(a),e.next=4,t.createOffer();case 4:return o=e.sent,e.next=7,t.setLocalDescription(o);case 7:r(n,o,c,s),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,a,n,r,c,s){return e.apply(this,arguments)}}(),A=function(){var e=Object(d.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.getUserMedia({video:!0,audio:!0});case 3:return t=e.sent,e.abrupt("return",t);case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),R=function(){var e=Object(d.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=new RTCPeerConnection({iceServers:[{urls:"stun:stun2.1.google.com:19302"}]}),e.abrupt("return",t);case 6:e.prev=6,e.t0=e.catch(0),console.error(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),V=function(e,t,a,n,r,c){e.onicecandidate=function(e){e.candidate&&c(a,e.candidate,n,t)},e.ontrack=function(e){r.srcObject!==e.streams[0]&&(r.srcObject=e.streams[0])}},W=function(){var e=Object(d.a)(m.a.mark((function e(t,a,n,r,c,s){var o,i;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.addStream(a),o=JSON.parse(n.offer),t.setRemoteDescription(o),e.next=6,t.createAnswer();case 6:i=e.sent,t.setLocalDescription(i),r(n.from,i,c,s),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.error(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t,a,n,r,c,s){return e.apply(this,arguments)}}(),F=function(){var e=Object(d.a)(m.a.mark((function e(t,a,n){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.ref("/notifs/"+t).remove();case 2:a.ref("/notifs/"+t).on("value",(function(e){e.exists()&&n(e.val(),t)}));case 3:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),J=function(){var e=Object(d.a)(m.a.mark((function e(t,a,n,r){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.ref("/notifs/"+t).set({type:"offer",from:r,offer:JSON.stringify(a)});case 2:case"end":return e.stop()}}),e)})));return function(t,a,n,r){return e.apply(this,arguments)}}(),P=function(){var e=Object(d.a)(m.a.mark((function e(t,a,n,r){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.ref("/notifs/"+t).update({type:"answer",from:r,answer:JSON.stringify(a)});case 2:case"end":return e.stop()}}),e)})));return function(t,a,n,r){return e.apply(this,arguments)}}(),z=function(){var e=Object(d.a)(m.a.mark((function e(t,a,n,r){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.ref("/notifs/"+t).update({type:"candidate",from:r,candidate:JSON.stringify(a)});case 2:case"end":return e.stop()}}),e)})));return function(t,a,n,r){return e.apply(this,arguments)}}(),H=a(48),K=a.n(H);a(131);console.log(O.a.name),console.log(O.a.database());r.a.Component;var Z=function(e){var t=Object(l.c)(T),a=(Object(l.c)(U),Object(l.b)());return r.a.createElement("div",{className:"contact-profile"},r.a.createElement("img",{src:"http://emilcarlsson.se/assets/harveyspecter.png",alt:""}),r.a.createElement("p",null,t),r.a.createElement("div",{className:"social-media"},r.a.createElement(o.a,{icon:i.b}),r.a.createElement(o.a,{icon:i.a}),r.a.createElement(o.a,{icon:i.c}),r.a.createElement(o.a,{onClick:function(){return a(N("true"))},icon:C.d})))},Y=function(e){Object(v.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(p.a)(this,a),(n=t.call(this,e)).sendMessage=function(e){e.preventDefault();var t=j.database().ref("messages"),a=n.state.messageList;t.push({message:n.state.message,date:Date.now(),username:n.props.Username,color:n.props.Color,deleted:!1}),n.setState({messageList:a,message:""})},n.state={messageList:[],message:"",username:n.props.Username,color:n.props.Color},n.sendMessage=n.sendMessage.bind(Object(y.a)(n)),n.handleMessage=n.handleMessage.bind(Object(y.a)(n)),n}return Object(f.a)(a,[{key:"handleMessage",value:function(e){this.setState({message:e.target.value})}},{key:"render",value:function(){return r.a.createElement("div",{className:"message-input"},r.a.createElement("div",{class:"wrap"},r.a.createElement("form",{onSubmit:this.sendMessage},r.a.createElement("input",{value:this.state.message,onChange:this.handleMessage,type:"text",placeholder:"Write your message..."}),r.a.createElement("button",{type:"submit",className:"submit"},r.a.createElement(o.a,{icon:C.a})))))}}]),a}(r.a.Component),q=a(24);function G(e){var t=Object(l.c)(T),a=Object(n.useState)(""),c=Object(q.a)(a,2),s=c[0],o=c[1],i=Object(n.useState)(""),u=Object(q.a)(i,2),m=(u[0],u[1],Object(l.b)());return""==t||null==t||void 0==t?r.a.createElement("div",{id:"LoginForm"},r.a.createElement("h3",null,"Who are you?"),r.a.createElement("input",{value:s,onChange:function(e){return o(e.target.value)},type:"text",placeholder:"Nickname"}),r.a.createElement("input",{type:"text",placeholder:"Email"}),r.a.createElement("input",{type:"password",placeholder:"Password"}),r.a.createElement("button",{onClick:function(){return m(x(s))}},"Login")):r.a.createElement("div",null)}function Q(e){var t=Object(l.c)(T),a=Object(l.c)(D),c=Object(n.useState)(""),s=Object(q.a)(c,2),o=s[0],i=s[1],u=Object(n.useState)(""),m=Object(q.a)(u,2),d=(m[0],m[1],Object(l.b)()),p=""==t||null==t||void 0==t;return"true"==a?r.a.createElement(G,null):p?r.a.createElement("div",{id:"LoginForm"},r.a.createElement("h3",null,"Who are you?"),r.a.createElement("input",{value:o,onChange:function(e){return i(e.target.value)},type:"text",placeholder:"Nickname"}),r.a.createElement("input",{type:"password",placeholder:"Password"}),r.a.createElement("button",{onClick:function(){return d(x(o))}},"Login"),r.a.createElement("div",{class:"register-message"},"If you are not registered yet, you can register by clicking ",r.a.createElement("span",{class:"span-link",onClick:function(){return d(L("true"))}},"here"),"!")):r.a.createElement("div",null)}var $=Object(w.b)({name:"counter",initialState:{value:0},reducers:{increment:function(e){e.value+=1},decrement:function(e){e.value-=1},incrementByAmount:function(e,t){e.value+=t.payload}}}),X=$.actions,ee=(X.increment,X.decrement,X.incrementByAmount,$.reducer);a(29);var te=a(89),ae=function(e){Object(v.a)(a,e);var t=Object(h.a)(a);function a(e){return Object(p.a)(this,a),t.call(this,e)}return Object(f.a)(a,[{key:"deleteMessage",value:function(e){j.database().ref("messages/"+e.currentTarget.getAttribute("data-id")).update({deleted:!0});var t=K()("span[data-id='"+e.currentTarget.getAttribute("data-id")+"']");K()(t).closest("p").html("Bu mesaj silindi")}},{key:"render",value:function(){var e="sent",t="";this.props.Sent||(e="replies",t=r.a.createElement("span",{"data-id":this.props.Id,onClick:this.deleteMessage},"Sil"));var a=new Date(this.props.Date),n=a.getUTCHours(),c=a.getUTCMinutes(),s=r.a.createElement("p",{className:this.props.Color},this.props.Text," ",r.a.createElement("div",null," ",t," ",r.a.createElement("span",null,n,":",c)));if(this.props.Deleted){var o=this.props.Color+" deleted";s=r.a.createElement("p",{className:o},"Bu mesaj silindi")}return r.a.createElement("li",{className:e},r.a.createElement("img",{src:"http://emilcarlsson.se/assets/mikeross.png",alt:""}),s)}}]),a}(r.a.Component);console.log(O.a.name),console.log(O.a.database());var ne=function(e){Object(v.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(p.a)(this,a),(n=t.call(this,e)).componentDidMount=Object(d.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),n.accept=function(){var e=n.props.callid;O.a.database().ref("calls/"+e).update({accepted:!0})},n.reject=function(){var e=n.props.callid;O.a.database().ref("calls/"+e).update({rejected:!0,deleted:!0})},n.accept=n.accept.bind(Object(y.a)(n)),n}return Object(f.a)(a,[{key:"render",value:function(){var e=r.a.createElement("div",{class:"calling"},r.a.createElement("p",null,this.props.from," calling!"),r.a.createElement(o.a,{onClick:this.accept,className:"accept call",icon:C.b}),r.a.createElement(o.a,{onClick:this.reject,className:"reject call",icon:C.c}));return"true"==this.props.showVideo&&(e=r.a.createElement(B,{user:"",connectedUser:!0,id:this.props.callid})),e}}]),a}(r.a.Component),re=function(e){Object(v.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(p.a)(this,a),(n=t.call(this,e)).state={username:n.props.Username,messageList:[],callList:[]},n}return Object(f.a)(a,[{key:"componentDidMount",value:function(){var e=this;j.database().ref("messages").on("value",(function(t){var a=t.val(),n=[];for(var r in a)n.push({id:r,message:a[r].message,date:a[r].date,username:a[r].username,color:a[r].color,deleted:a[r].deleted});e.setState({messageList:n})})),this.scrollToBottom(),j.database().ref("calls").on("value",(function(t){var a=t.val(),n=[];for(var r in a)n.push({id:r,from:a[r].from,to:a[r].to,accepted:a[r].accepted,rejected:a[r].rejected,deleted:a[r].deleted});e.setState({callList:n})}))}},{key:"componentDidUpdate",value:function(){this.scrollToBottom()}},{key:"scrollToBottom",value:function(){te.animateScroll.scrollToBottom({containerId:"message-list"})}},{key:"render",value:function(){var e=this,t=(r.a.createRef(),this.props.Username),a=this.state.callList.filter((function(e){return e.to===t&&!1===e.accepted&&!1===e.rejected&&!1===e.deleted})),n=this.state.callList.filter((function(e){return e.to===t&&!0===e.accepted&&!1===e.rejected&&!1===e.deleted})),c="";return""!=t&&null!=a&&a.length>0&&(c=r.a.createElement(ne,{callid:a[0].id,from:a[0].from})),""!=t&&null!=n&&n.length>0&&(c=r.a.createElement(ne,{showVideo:"true",callid:n[0].id,from:n[0].from})),""!=this.props.Username?r.a.createElement("div",{id:"message-list",className:"messages"},c,r.a.createElement("div",null,r.a.createElement("ul",null,Object.keys(this.state.messageList).map((function(t){return r.a.createElement(ae,{Id:e.state.messageList[t].id,Color:e.state.messageList[t].color,Sent:e.props.Username!=e.state.messageList[t].username,Username:e.state.messageList[t].username,Text:e.state.messageList[t].message,Deleted:e.state.messageList[t].deleted,Date:e.state.messageList[t].date})}))))):r.a.createElement("div",{className:"messages"})}}]),a}(r.a.Component),ce=function(){var e=Object(l.c)(T),t=Object(l.c)(U),a="";return"true"==Object(l.c)(M)&&(a=r.a.createElement(B,{user:e})),r.a.createElement("div",{id:"frame"},r.a.createElement("div",{className:"content"},r.a.createElement(Z,null),r.a.createElement(re,{Username:e}),r.a.createElement(Y,{Username:e,Color:t}),r.a.createElement(Q,null),r.a.createElement(G,null),a))},se=Object(w.a)({reducer:{counter:ee,member:_}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(l.a,{store:se},r.a.createElement(ce,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},29:function(e,t,a){e.exports={row:"Counter_row__3I6R-",value:"Counter_value__3vN1l",button:"Counter_button__THz-Z",textbox:"Counter_textbox__2xOQK",asyncButton:"Counter_asyncButton__1A7PP Counter_button__THz-Z"}},92:function(e,t,a){}},[[134,1,2]]]);
//# sourceMappingURL=main.30a14d5d.chunk.js.map